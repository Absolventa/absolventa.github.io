<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Devnull - Watching A Certificate Revocation List Using Event Girl</title>
  <meta name="author" content="ABSOLVENTA" />
  <meta name="description" content="The blog of the ABSOLVENTA Dev Team" />
  <link rel="canonical" href="http://devnull.absolventa.de/2013/10/28/watching-a-certificate-revocation-list-using-event-girl/" />

  <!-- <link href="//fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"> -->
  <!-- <link href='http://fonts.googleapis.com/css?family=Gudea' rel='stylesheet' type='text/css'> -->
  <link href='http://fonts.googleapis.com/css?family=Rosario' rel='stylesheet' type='text/css'>
  <link rel="shortcut icon" href="/favicon.png">
  <link rel="alternate" type="application/rss+xml" title="Devnull" href="http://devnull.absolventa.de/feed.xml" />

  <link rel="stylesheet" href="/assets/css/all.css">
<!--[if IE 7]>
  <link rel="stylesheet" href="/assets/css/font-awesome-ie7.min.css">
<![endif]-->
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <a href="/">
    <img src="/images/absolventa_logo_large.png" id="logo" alt="Blog logo"/>
  </a>
  <h1><a href="/">Devnull</a></h1>
  <hr/>
  <ul>
    <p>The Blog of the <a href="https://www.absolventa.de/">ABSOLVENTA</a> Dev Team.</p>
  <hr/>
  <div>
    <div id="social">
      Follow us:
<div id="stalker">
  
  <a title="Absolventa on Github" href="http://github.com/Absolventa">
    <i class="icon-github-sign"></i>
  </a>
  

  

  
  <a title="ABSOLVENTA on Twitter" href="http://twitter.com/ABSOLVENTA">
    <i class="icon-twitter-sign"></i>
  </a>
  

  <a title="RSS feed" id="rss" href="/feed.xml">
    <i class="icon-rss-sign"></i>
  </a>
</div>

    </div>
  </div>
  </ul>
</nav>

    </div>

    <div class="eleven columns content">
      <h1 class="title">Watching A Certificate Revocation List Using Event Girl</h1>

<p class="meta">
  Posted on October 28, 2013 by Carsten Zimmermann
  <ul class="tags">
  
    <li><a href='/tag/event-girl'>event-girl</a></li>
  
    <li><a href='/tag/openssl'>openssl</a></li>
  
    <li><a href='/tag/devops'>devops</a></li>
  
    <li><a href='/tag/wifi'>wifi</a></li>
  
</ul>
<div style="clear:both"></div>

</p>

<div id="post">
  
<p>ABSOLVENTA uses WPA2-Enterprise to control acccess to the company’s wifi network. Authentication is done using x509 certificates issued by our local, self-signed Certificate Authority (CA). We use a FreeRadius server on a <a href="https://www.freebsd.org">FreeBSD</a> machine to check for the validity of the presented certificate.</p>

<p>I wrote a simple <abbr title='Command Line Interface'>CLI</abbr> to faciliate the certificate management and to automatically configure the Radius server, including certificate revocation. The next-update field of the generated <a href="http://en.wikipedia.org/wiki/Certificate_revocation_list">certificate revocation list</a> (CRL) file is set to +100 days whenever a certificate is revoked, assuming there will always be at least an intern who leaves the company within three months’ time.</p>

<p>Yesterday morning, I was denied access to our wifi network. Working from an ethernet-less Macbook Air I had to wire myself somewhere to debug the problem. The Radius server was alive and kicking but looking at the logs it was evident that it couldn’t verify certificates anymore as its CRL was no longer valid.</p>

<p>Regenerating a new CRL was easy enough, but it was clear that my initial assumption of »100 days is a safe enough bet« was false. I didn’t want to increase the lifetime of the CRL as an overly old CRL kind of defeats its purpose. I wrote a simple Ruby CRL parser named <a href="https://github.com/Absolventa/crl_watchdog">crl_watchdog</a> and a shell script as an early warning system:</p>
<script src='https://gist.github.com/7196906.js'><![CDATA[ ]]></script>
<p>The file resides in <code>/etc/periodic/daily</code> which is FreeBSD’s equivalent of <code>/etc/cron.daily</code> on most Linux distributions.</p>

<p>You’ll notice the various <a href="https://github.com/Absolventa/event_girl">Event Girl</a> statements: The shell script makes use of the <a href="https://github.com/Absolventa/event_girl_client">event_girl_client</a> CLI. Event Girl is the outcome of the <a href="http://railsgirlssummerofcode.org">Rails Girls Summer of Code</a> team <a href="http://highwaytorails.tumblr.com">Highway to Rails</a> we’ve been hosting from July 1st to September 30th and it’s awesome.</p>

<p>The Event Girl app has two event expectations: one »backward« expectation that will inform us when the daily script doesn’t run for whatever reason and a »forward« one which will send an email instantly when the CRL will expire within the next 14 days (as notified in line 20).</p>

<p>Using Event Girl, I can not only make sure not to run into an outdated CRL again, but also feel at ease that the CRL actually remains being monitored. Also, I don’t have to bother about sending mails from the server and can leave that to the Event Girl app.</p>

</div>

<div id="related">
  <h3>Related Posts</h3>
  <ul class="posts">
    
    <li>
      <span>10 Oct 2013 &raquo;</span> <a href="/2013/10/10/rate-limiting-with-activerecord-base-find_each-in-edge-rails/">Rate Limiting Work On ActiveRecord::Base With .find_each In Edge Rails</a>
    </li>
    
    <li>
      <span>08 Oct 2013 &raquo;</span> <a href="/2013/10/08/Markdown/">Markdown</a>
    </li>
    
    <li>
      <span>07 Oct 2013 &raquo;</span> <a href="/2013/10/07/Welcome/">Welcome</a>
    </li>
    
  </ul>
</div>

    
      <div class="footer">
        <div class="disclaimer">
  

  <p>
    © ABSOLVENTA, 2013 &mdash; built with Jekyll using Lagom theme
  </p>
</div>

      </div>
    </div>
  </div>


<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
   var t   = document.createElement('script');
   t.type  = 'text/javascript';
   t.async = true;
   t.id    = 'gauges-tracker';
   t.setAttribute('data-site-id', '52567bcc613f5d6ad7000042');
   t.src = '//secure.gaug.es/track.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(t, s);
   })();
</script>



</body>
</html>
