<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>Devnull</title>
  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/style.css" rel="stylesheet" />
  <!-- <link href="/assets/css/colors-dark.css" rel="stylesheet" /> -->
  <link href="/assets/css/colors-light.css" rel="stylesheet" />

</head>

<body>



  <header id="header">
    <img id="logo" src="/images/absolventa_logo_large.png">
    <h1><a href="/">Devnull</a></h1>
    <p>The blog of the ABSOLVENTA Dev Team</p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <!-- <li><a href="/about">About</a></li>
          <li><a href="http://twitter.com/redwall_hp">Twitter</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li> -->
        </ul>
      </nav>
    </div>



    <div id="content">
      

	<article class="post">

		
			<h1><a href="/2013/10/28/watching-a-certificate-revocation-list-using-event-girl/">Watching A Certificate Revocation List Using Event Girl</a></h1>
		

		<div class="post-content">
<p>ABSOLVENTA uses WPA2-Enterprise to control acccess to the company’s wifi network. Authentication is done using x509 certificates issued by our local, self-signed Certificate Authority (CA). We use a FreeRadius server on a <a href="https://www.freebsd.org">FreeBSD</a> machine to check for the validity of the presented certificate.</p>

<p>I wrote a simple <abbr title='Command Line Interface'>CLI</abbr> to faciliate the certificate management and automatically configuring the Radius server, including certificate revocation. The next-update field of the generated <a href="http://en.wikipedia.org/wiki/Certificate_revocation_list">certificate revocation list</a> (CRL) file is set to +100 days whenever a certificate is revoked, assuming there will always be at least an intern who leaves the company within three months’ time.</p>

<p>Yesterday morning, I was denied access to our wifi network. Working from an ethernet-less Macbook Air I had to wire myself somewhere to debug the problem. The Radius server was alive and kicking but looking at the logs it was evident that it couldn’t verify certificates anymore as its CRL was no longer valid.</p>

<p>Regenerating a new CRL was easy enough, but it was clear that my initial assumption of »100 days is a safe enough bet« was false. I didn’t want to increase the lifetime of the CRL as an overly old CRL kind of defeats its purpose. I wrote a simple Ruby CRL parser named <a href="https://github.com/Absolventa/crl_watchdog">crl_watchdog</a> and a shell script as an early warning system:</p>
<script src='https://gist.github.com/7196906.js'><![CDATA[ ]]></script>
<p>The file resides in <code>/etc/periodic/daily</code> which is FreeBSD’s equivalent of <code>/etc/cron.daily</code> on most Linux distributions.</p>

<p>You’ll notice the various <a href="https://github.com/Absolventa/event_girl">Event Girl</a> statements: The shell script makes use of the <a href="https://github.com/Absolventa/event_girl_client">event_girl_client</a> CLI. Event Girl is the outcome of the <a href="http://railsgirlssummerofcode.org">Rails Girls Summer of Code</a> team <a href="http://highwaytorails.tumblr.com">Highway to Rails</a> we’ve been hosting from July 1st to September 30th and it’s awesome.</p>

<p>The Event Girl app has two event expectations: one »backward« expectation that will inform us when the daily script doesn’t run for whatever reason and another that will send an email instantly when the CRL will expire within the next 14 days (line 22).</p>

<p>Using Event Girl, I can not only make sure not to run into an outdated CRL again, but also feel at ease that the CRL actually remains being monitored. Also, I don’t have to bother about sending mails from the server and can leave that to the Event Girl app.</p>
</div>

	</article>



	<article class="post">

		
			<h1><a href="/2013/10/10/rate-limiting-with-activerecord-base-find_each-in-edge-rails/">Rate Limiting Work On ActiveRecord::Base With .find_each In Edge Rails</a></h1>
		

		<div class="post-content">
<p>I was working with several maintenance tasks that query external webservices for a collection of ActiveRecord objects. In order to avoid hitting the webservices’ rate limit, we pause every other iteration for a fraction of a second before we continue.</p>

<p>The code looks something like this:</p>
<script src='https://gist.github.com/6920157.js?file=old_code.rb'><![CDATA[ ]]></script>
<p>I didn’t like that the information of our rate limit guard clauses was so scattered: there were bits before the block and others in the block. I had the urge to refactor it into a more concise form using a Ruby block itself.</p>

<p>My idea was to create a method that takes the rate limit, the sleep time and an enumeration and then yield the elements of the enum to a block.</p>

<p>I wrapped that method into a module and out came this:</p>
<script src='https://gist.github.com/6920157.js?file=rate_limiter.rb'><![CDATA[ ]]></script>
<p>This is how the specs look like:</p>
<script src='https://gist.github.com/6920157.js?file=rate_limiter_spec.rb'><![CDATA[ ]]></script>
<p>Unfortunately and unlike other enumerable methods, the batch finder <code>ActiveRecord::Base.find_each</code> does not return an Enumerator when called without a block. Not in Rails 3.2 and not in Rails 4.0.</p>

<p>Luckily, it has been solved in Edge Rails (see <a href="https://github.com/rails/rails/commit/840c552047a660d0a66883fb9c0cb144d5e728fb">840c552</a>) and I quickly created a Rails 4.1.0.beta app to go for the following code:</p>
<script src='https://gist.github.com/6920157.js?file=external_service.rb'><![CDATA[ ]]></script>
<p><code>ActiveRecord::Base.find_each</code> now returns a proper <code>Enumerator</code> that can be passed into the rate limiter. If you want to learn more about Enumerators in Ruby (or if you’d like to refresh your memory), I can recommend this excellent <a href="http://devblog.avdi.org/2013/09/10/rubytapas-freebie-enumerator/">Ruby Tapas</a> episode by <a href="https://twitter.com/avdi">Avdi Grimm</a>.</p>
</div>

	</article>



	<article class="post">

		
			<h1><a href="/2013/10/08/Markdown/">Markdown</a></h1>
		

		<div class="post-content">
<p><strong>Liebe Leserinnen, liebe Leser,</strong></p>

<p>heute gibt es den zweiten Eintrag im neuen Dev-Blog. Er wird vor allem Syntax-Beispiele für das Gestalten eines Blogeintrages enthalten und richtet sich somit eher an das Dev-Team.</p>
<!-- more -->
<h2 id="grundlegendes">Grundlegendes</h2>

<p>Die Blogs werden in “markdown” verfasst. Das ist ein text-to-HTML conversion tool, was dem Schreiberling die Möglichkeit bietet, leicht zu lesenden (“Quell”-)Text zu verfassen und zu gestalten, ohne HTML erlernen zu müssen. Ein paar einfache Regeln genügen um mit Hilfe von “markdown” valides HTML zu generieren.</p>

<h2 id="syntax">Syntax</h2>

<p>Nun folgen ein paar einfache Beispiele</p>

<h3 id="berschriften">Überschriften</h3>

<p>Überschriften werden mittels <code>#</code> als solche gekennzeichnet.</p>

<pre><code># Überschrift 1
## Überschrift 2
##### Überschrift 5</code></pre>

<p>Am Ende können abschließende <code>#</code> gesetzt werden, was allerdings nicht nötig ist.</p>

<h3 id="darstellungen">Darstellungen</h3>

<p>Worte und Textpassagen können <em>kursiv</em>, <strong>fett</strong> oder <strong><em>fett&amp;kursiv</em></strong> sein. Auch hierfür gibt es entsprechende Tags, die genutzt werden können.</p>

<pre><code>*kursiv* oder _kursiv_
**fett\*\* *oder* __fett__
***fett&amp;kursiv*** oder ___fett&amp;kursiv___ </code></pre>

<h3 id="listen_aufzhlungen">Listen, Aufzählungen</h3>

<p>Listen, geordnet, verschachtelt, mit und ohne Nummerierung sind einfach durch das entsprechende Aufzählungszeichen (Ziffern <code>[0..9]</code>, <code>*</code>, <code>-</code> oder <code>+</code>) am Beginn der Zeile zu erzeugen. Die Einrückung entsteht durch einfache Leerzeichen vor der Zeile.</p>

<ol>
<li>Erstes Element</li>

<li>Zweites Element</li>
</ol>

<pre><code>a. Erstes Unterelement von Element 2</code></pre>

<ol>
<li>Drittes Element</li>
</ol>

<pre><code>* Ein ungeordnetes Unterelement von Element 3</code></pre>

<p>Der entsprechende Code ist</p>

<pre><code>1. Erstes Element
2. Zweites Element
  a. erstes Unterelement von Element 2
3. Drittes Element
  * Ein ungeordnetes Unterelement von Element 3</code></pre>

<h3 id="quellcode">Quellcode</h3>

<p>Quelltexte, Codeschnipsel und Ähnliches können mittels markdown sehr komportabel dargestellt werden. Als erstes ein ein Biespiel für eine kleine Ruby-Funktion</p>
<div class='highlight'><pre><code class='ruby'><span class='k'>def</span> <span class='nf'>say_hello</span>
  <span class='nb'>puts</span> <span class='s1'>&#39;Hello&#39;</span>
<span class='k'>end</span>
</code></pre></div>
<p>Die Quellcode als solchen darzustellen müssen die Zeilen nur mittels Tab (oder 4 Leerzeichen) eingerückt werden. Wenn jedoch Syntax-Highlighting unterstützt werden soll, muss der Code mit <code>{</code><code>% highlight ruby %}</code> eingeleitet werden. Die letzte Zeile schließt ihn mit <code>{</code><code>% endhighlight %}</code> ab.</p>

<p>Markdown unterstützt hierbei im Übrigen alle gängigen Sprachen und stellt den Quellcode spezifisch dar. Dazu muss nur die entsprechende Sprache am Anfang angegeben werden, z.B. für Java <code>&#39;{</code><code>% highlight java %}</code> … <code>{</code><code>% endhighlight %}</code>.</p>

<h3 id="zitate_kommentare">Zitate, Kommentare</h3>

<p>Zitate, Kommentare oder Ähnliches werden mittels <code>&gt;</code> erzeugt werden.</p>

<blockquote>
<p>Das ist ein Zitat.</p>
</blockquote>

<p>sieht in der markdown-Syntax so aus:</p>

<pre><code>&gt; Das ist ein Zitat.</code></pre>
</div>

	</article>



	<article class="post">

		
			<h1><a href="/2013/10/07/Welcome/">Welcome</a></h1>
		

		<div class="post-content">
<p><strong>Dear Reader</strong></p>

<p>This is the brand new blog from the Dev-Team of ABSOLVENTA with a lot of important and interesting stuff everybody should know!</p>

<p>Stay tuned!</p>
</div>

	</article>






    </div>



  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2013 Absolventa GmbH. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="http://www.webmaster-source.com">Matt Harzewski</a></p>
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>

  <script type="text/javascript">
    var _gauges = _gauges || [];
    (function() {
      var t   = document.createElement('script');
      t.type  = 'text/javascript';
      t.async = true;
      t.id    = 'gauges-tracker';
      t.setAttribute('data-site-id', '52567bcc613f5d6ad7000042');
      t.src = '//secure.gaug.es/track.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(t, s);
    })();
  </script>



</body>
</html>